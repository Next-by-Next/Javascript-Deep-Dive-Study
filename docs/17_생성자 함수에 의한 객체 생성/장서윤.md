ê°ì²´ë¥¼ ìƒì„±í•˜ëŠ” ë°©ë²•ì— ë¬´ì—‡ì´ ìˆëŠ”ê°€!

## ğŸ’¡ 17.1 Object ìƒì„±ì í•¨ìˆ˜

- **ìƒì„±ì í•¨ìˆ˜(constructor)**

  - `new` ì—°ì‚°ìì™€ í•¨ê»˜ í˜¸ì¶œí•˜ì—¬ ê°ì²´(ì¸ìŠ¤í„´ìŠ¤)ë¥¼ ìƒì„±í•˜ëŠ” í•¨ìˆ˜
  - ë¹ˆ ê°ì²´ ìƒì„±í•˜ì—¬ ë°˜í™˜ â‡’ í”„ë¡œí¼í‹°/ë©”ì„œë“œ ì¶”ê°€
  - `new Object()` `new String()` `new Number()` `new Date()` (ë¹ŒíŠ¸ì¸ ìƒì„±ì í•¨ìˆ˜ ì œê³µ)

    ```jsx
    const person = new Object();

    person.name = "Lee";
    person.sayHello = function () {
      console.log("Hi! My name is " + this.name);
    };

    console.log(person); // {name: "Lee", sayHello: Æ’}
    person.sayHello(); // Hi! My name is Lee
    ```

    - `new Object()` ë³´ë‹¤ëŠ” ê°ì²´ ë¦¬í„°ëŸ´`{}`ì´ ë” ê°„í¸. ë¬´ì¡°ê±´ ìƒì„±ì í•¨ìˆ˜ë¥¼ ì¨ì•¼í•˜ëŠ”ê²Œ X
    - ê·¸ëŸ¬ë‚˜, ê°ì²´ ë¦¬í„°ëŸ´`{}`ì˜ ê²½ìš° ìˆ˜ì‹­ê°œì˜ ê°ì²´ë¥¼ ìƒì„±í•´ì•¼í•œë‹¤ë©´? **ë¹„íš¨ìœ¨ì !**

## ğŸ’¡ 17.2 ìƒì„±ì í•¨ìˆ˜

### âœ¨ ìƒì„±ì í•¨ìˆ˜ â†’ ê°ì²´ ìƒì„± ë°©ì‹

- `this` : ìì‹ ì˜ í”„ë¡œí¼í‹°/ë©”ì„œë“œë¥¼ ì°¸ì¡°í•˜ê¸° ìœ„í•œ **ìê¸° ì°¸ì¡° ë³€ìˆ˜**

```jsx
function Circle(radius) {
  this.radius = radius;
  this.getDiameter = function () {
    return 2 * this.radius;
  };
}

const circle1 = new Circle(5);
console.log(circle1.getDiameter()); // 10
```

- ë§Œì•½ `new` ì—°ì‚°ìê°€ ì—†ë‹¤ë©´? ì¼ë°˜ í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œ!

```jsx
function Circle(radius) {
  this.radius = radius;
  this.getDiameter = function () {
    return 2 * this.radius;
  };
}

console.log(Circle(5)); // undefined ë°˜í™˜! í˜„ì¬ Circleì— returnì´ ì—†ìœ¼ë¯€ë¡œ!
```

### âœ¨ ìƒì„±ì í•¨ìˆ˜ â†’ ì¸ìŠ¤í„´ìŠ¤ ìƒì„± ê³¼ì •

1. ì•”ë¬µì ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³  `this`ì— ë°”ì¸ë”©ëœë‹¤.
2. `this`ì— ë°”ì¸ë”©ë˜ì–´ ìˆëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•œë‹¤. (by ê°œë°œì)
3. ì•”ë¬µì ìœ¼ë¡œ `this`ë¥¼ ë°˜í™˜í•œë‹¤.

```jsx
function Circle(radius) {
  // 1. ì•”ë¬µì ìœ¼ë¡œ ì¸ìŠ¤í„´ìŠ¤ê°€ ìƒì„±ë˜ê³  thisì— ë°”ì¸ë”©ëœë‹¤.
  console.log(this); // Circle {}

  // 2. thisì— ë°”ì¸ë”©ë˜ì–´ ìˆëŠ” ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì´ˆê¸°í™”í•œë‹¤.
  this.radius = radius;
  this.getDiameter = function () {
    return 2 * this.radius;
  };

  // 3. ì•”ë¬µì ìœ¼ë¡œ thisë¥¼ ë°˜í™˜í•œë‹¤.
}

// ì¸ìŠ¤í„´ìŠ¤ ìƒì„±. Circle ìƒì„±ì í•¨ìˆ˜ëŠ” ëª…ì‹œì ìœ¼ë¡œ ë°˜í™˜í•œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤.
const circle = new Circle(1);
console.log(circle); // Circle {radius: 1, getDiameter: Æ’}
```

- ë§Œì•½, **ê°ì²´**ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë°˜í™˜í•  ê²½ìš° ë°˜í™˜ì€ ë¨.

  ```jsx
  // ìƒëµ
     return {};
  }

  console.log(new Circle(1)); // {}
  ```

- ê·¸ëŸ¬ë‚˜, **ì›ì‹œê°’**ì„ ëª…ì‹œì ìœ¼ë¡œ ë°˜í™˜í•  ê²½ìš°, ì´ëŠ” ë¬´ì‹œë˜ê³  `this`ê°€ ë°˜í™˜ëœë‹¤!

  ```jsx
  // ìƒëµ
     return 1;
  }

  console.log(new Circle(1)); // Circle {radius: 1, getDiameter: Æ’}
  ```

### âœ¨ ë‚´ë¶€ ë©”ì„œë“œ **`[[Call]]`Â `[[Construct]]`**

- í•¨ìˆ˜ëŠ” ê°ì²´ë¡œì¨, í”„ë¡œí¼í‹°, ë©”ì„œë“œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤.

  ```jsx
  function foo() {}

  foo.prop = 10;

  foo.method = function () {
    console.log(this.prop);
  };
  ```

- ê·¸ëŸ¬ë‚˜ ì¼ë°˜ê°ì²´ì™€ëŠ” ë‹¤ë¥´ê²Œ í•¨ìˆ˜ëŠ” **í˜¸ì¶œ**í•  ìˆ˜ ìˆë‹¤! ì–´ë–»ê²Œ?

  - **í•¨ìˆ˜** í˜¸ì¶œ â†’ í•¨ìˆ˜ ê°ì²´ì˜ ë‚´ë¶€ ë©”ì„œë“œ `[[Call]]` í˜¸ì¶œ
    - **`callable`**: ë‚´ë¶€ ë©”ì„œë“œ `[[Call]]` ì„ ê°–ëŠ” í•¨ìˆ˜ ê°ì²´
  - **ìƒì„±ì í•¨ìˆ˜**(new ì—°ì‚°ì) í˜¸ì¶œ â†’ ë‚´ë¶€ ë©”ì„œë“œ `[[Construct]]` í˜¸ì¶œ
    - **`constructor`:** ë‚´ë¶€ ë©”ì„œë“œ `[[Construct]]` ì„ ê°–ëŠ” í•¨ìˆ˜ ê°ì²´ â†” **`non-constructor`**

  ```jsx
  function foo() {}

  // ì¼ë°˜ì ì¸ í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œ: [[Call]]ì´ í˜¸ì¶œëœë‹¤.
  foo();

  // ìƒì„±ì í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œ: [[Construct]]ê°€ í˜¸ì¶œëœë‹¤.
  new foo();
  ```

  â‡’ í•¨ìˆ˜ ê°ì²´ëŠ” í˜¸ì¶œë˜ì–´ì•¼ í•˜ë¯€ë¡œ, **`callable`**ì´ì–´ì•¼ í•˜ì§€ë§Œ, **`constructor`**ëŠ” ì¼ìˆ˜ë„, ì•„ë‹ìˆ˜ë„!
  â‡’ ê·¸ë ‡ë‹¤ë©´ **`constructor`, `non-constructor`** ëŠ” ì–´ë–»ê²Œ ì••ë‹ˆê¹Œ! ë°‘ì—ì„œ ê³„ì†â€¦

### âœ¨ **`constructor`, `non-constructor` êµ¬ë¶„**

- í•¨ìˆ˜ ì •ì˜ ë°©ì‹ì— ë”°ë¼ êµ¬ë¶„ë¨
- **`constructor`**
  - í•¨ìˆ˜ ì„ ì–¸ë¬¸, í•¨ìˆ˜ í‘œí˜„ì‹, í´ë˜ìŠ¤(í´ë˜ìŠ¤ë„ í•¨ìˆ˜)
- **`non-constructor`** (new ìƒì„±ìë¡œ í˜¸ì¶œ X)
  - ë©”ì„œë“œ(ES6 ë©”ì„œë“œ ì¶•ì•½ í‘œí˜„), í™”ì‚´í‘œ í•¨ìˆ˜
- ğŸš¨ **ì£¼ì˜** : ë©”ì„œë“œë¡œ ì¸ì •í•˜ëŠ” ë²”ìœ„ê°€ ì¼ë°˜ì ì¸ ì˜ë¯¸ë³´ë‹¤ ì¢ë‹¤!

```jsx
function foo() {} // => constructor
const bar = function () {}; // => constructor
const arrow = () => {}; // í™”ì‚´í‘œ í•¨ìˆ˜ => non-constructor

const obj = {
  print1: function () {
    // ë©”ì„œë“œ X, ì¼ë°˜ í•¨ìˆ˜ë¡œ ì •ì˜ ë¨ => constructor
    console.log("1");
  },
  print2() {
    // ë©”ì„œë“œ ì¶•ì•½ í‘œí˜„. ì´ê²ƒë§Œ ë©”ì„œë“œë¡œ ì¸ì •í•¨ =>  non-constructor
    console.log("2");
  },
};

new foo(); // -> foo {}
new bar(); // -> bar {}
new obj.print1(); // -> x {}

new arrow(); // TypeError: arrow is not a constructor
new obj.print2(); // TypeError: obj.print2 is not a constructor
```

### âœ¨ new ì—°ì‚°ì

- **ìƒì„±ì í•¨ìˆ˜**(new ì—°ì‚°ì)ì™€, ì¼ë°˜ í•¨ìˆ˜ì˜ ì°¨ì´ì ì€ ë¬´ì—‡ì¸ê°€!
  - `[[Call]]` ì„ í˜¸ì¶œí•˜ëŠ”ê°€ `[[Construct]]` ì„ í˜¸ì¶œí•˜ëŠ”ê°€ì˜ ì°¨ì´
  - ì¦‰, ìƒì„±ì í•¨ìˆ˜ë¡œ í˜¸ì¶œë˜ë ¤ë©´, `non-constructor` **ê°€ ì•„ë‹Œ **`constructor` ì—¬ì•¼ í•œë‹¤.
- ê·¸ë ‡ê¸°ì—, ìƒì„±ì í•¨ìˆ˜ëŠ” íŒŒìŠ¤ì¹¼ì¼€ì´ìŠ¤ë¡œ ëª…ëª…í•˜ì—¬ ì¼ë°˜ í•¨ìˆ˜ì™€ êµ¬ë¶„ì§“ì!

```jsx
function add(x, y) {
  return x + y;
}

let inst = new add();
console.log(inst); // add {}
// í•¨ìˆ˜ëŠ” ì›ì‹œê°’ì„ ë°˜í™˜í•˜ì§€, ê°ì²´ë¥¼ ë°˜í™˜í•˜ì§€ ì•ŠìŒ => ì´ì— thisì¸ add {}ê°€ ë°˜í™˜ë¨!
```

```jsx
function createUser(name, role) {
  return { name, role };
}

inst = new createUser("Lee", "admin");
console.log(inst); // {name: "Lee", role: "admin"}
// ë°”ë¡œ returní•˜ëŠ” ê°ì²´ë¥¼ ë°˜í™˜í•¨! ì›ì‹œê°’ì´ ì•„ë‹Œ ê°ì²´ë¥¼ return í•´ì¤¬ìœ¼ë‹ˆê¹Œ!
```

- ì¼ë°˜ í•¨ìˆ˜ë¡œ í˜¸ì¶œí• ë•Œ, `this`ëŠ” ì–´ë–»ê²Œ ë˜ëŠ”ê°€? ì›ë˜ëŠ” ìƒì„±í•  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°€ë¦¬í‚¤ëŠ”ë°..
  - ì „ì—­ ê°ì²´ **window**ë¥¼ ê°€ë¦¬í‚¨ë‹¤!!!

```jsx
function Circle(radius) {
  this.radius = radius;
  this.getDiameter = function () {
    return 2 * this.radius;
  };
}
// thisëŠ” ì „ì—­ ê°ì²´ windowë¥¼ ê°€ë¦¬í‚¤ê³ 
// radius, getDiameter ë©”ì„œë“œëŠ” ì „ì—­ê°ì²´ì˜ í”„ë¡œí¼í‹°ì™€ ë©”ì„œë“œê°€ ëœë‹¤!!!

const circle = Circle(5); // ì¼ë°˜ í•¨ìˆ˜ë¡œì¨ í˜¸ì¶œë¨.

console.log(circle); // undefined
console.log(radius); // 5
console.log(getDiameter()); // 10

circle.getDiameter(); // TypeError: Cannot read property 'getDiameter' of undefined
```

### âœ¨âœ¨âœ¨ new.target

- **ìƒì„±ì í•¨ìˆ˜ê°€ new ì—†ì´ í˜¸ì¶œë˜ëŠ” ê²ƒì„ ë°©ì§€**í•˜ê¸° ìœ„í•´ ì‚¬ìš©
  - ìƒì„±ì í•¨ìˆ˜ëŠ” íŒŒìŠ¤ì¹¼ ì¼€ì´ìŠ¤ ì»¨ë²¤ì…˜ì´ ìˆì§€ë§Œ, ì‹¤ìˆ˜í•  ìˆ˜ ìˆê¸° ë•Œë¬¸!
- `this`ì™€ ë¹„ìŠ·í•˜ê²Œ ì•”ë¬µì ì¸ ì§€ì—­ë³€ìˆ˜ì²˜ëŸ¼ ì‚¬ìš©ë¨. ğŸ’¡`ë©”íƒ€ í”„ë¡œí¼í‹°`!

- ìƒì„±ì í•¨ìˆ˜ë¡œì¨ í˜¸ì¶œë˜ë©´, **new.target** ì€ `í•¨ìˆ˜ ìì‹ `ì„ ê°€ë¦¬í‚¤ì§€ë§Œ
- ì¼ë°˜ í•¨ìˆ˜ë¡œì¨ í˜¸ì¶œë˜ë©´, **new.target** ì€ `undefined`!

- **new ìƒì„±ì í•¨ìˆ˜**ë¡œ í˜¸ì¶œí•˜ì§€ ì•Šì•„ë„, ë‚´ë¶€ì—ì„œ í• ë‹¹í•´ì£¼ëŠ” ì½”ë“œ

  ```jsx
  function Circle(radius) {
    if (!new.target) {
      // new ì—°ì‚°ìì™€ í•¨ê»˜ ìƒì„±ì í•¨ìˆ˜ë¥¼ ì¬ê·€ í˜¸ì¶œí•˜ì—¬ ìƒì„±ëœ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤.
      return new Circle(radius);
    }

    this.radius = radius;
    this.getDiameter = function () {
      return 2 * this.radius;
    };
  }

  // new ì—°ì‚°ì ì—†ì´ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ë„ new.targetì„ í†µí•´ ìƒì„±ì í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œëœë‹¤.
  const circle = Circle(5);
  console.log(circle.getDiameter());
  ```

- ê·¸ëŸ¬ë‚˜ ES6ì—ì„œ ë„ì…ëœ ìµœì‹ ë¬¸ë²•ìœ¼ë¡œ IEì—ì„  ì§€ì› X

  - **ìŠ¤ì½”í”„ ì„¸ì´í”„ ìƒì„±ì íŒ¨í„´** `instanceof`Â ì‚¬ìš©!

  ```jsx
  function Circle(radius) {
    if (!(this instanceof Circle)) {
      return new Circle(radius);
    }

    this.radius = radius;
    this.getDiameter = function () {
      return 2 * this.radius;
    };
  }

  const circle = Circle(5);
  console.log(circle.getDiameter()); // 10
  ```

- ë¹ŒíŠ¸ì¸ ìƒì„±ì í•¨ìˆ˜ëŠ” new ì—°ì‚°ìë¡œ í˜¸ì¶œë˜ì—ˆëŠ”ì§€ í™•ì¸í•œ í›„, ì ì ˆí•œ ê°’ ë°˜í™˜

  - `Object`,Â `Function`Â ëŠ” `new`ì—°ì‚°ì ì—†ì´ í˜¸ì¶œí•´ë„Â `new`ì—°ì‚°ì ìƒì„±ê³¼ ë™ì¼í•˜ê²Œ ë™ì‘
  - **ë°˜ë©´**, `String`,Â `Number`,Â `Boolean` ëŠ” newì—°ì‚°ì ìœ ë¬´ì— ë”°ë¼ **ê°ì²´/ì›ì‹œê°’** ë°˜í™˜!!

    ```jsx
    const num = Number("123");
    console.log(num, typeof num); // 123 number

    console.log(new Number("123")); // Number {123}
    ```
