## 22장 this

### 22.1 this 키워드

- 동작을 나타내는 메서드는 자신이 속한 객체의 상태(프로퍼티)를 참조하고 변경할 수 있어야 한다.
  -> 메서드가 프로퍼티를 참조하려면 자신이 속한 객체를 가리키는 식별자를 참조할 수 있어야 한다.
- 객체 리터럴 방식으로 생성한 객체
  - 메서드 내부에서 식별자를 재귀적으로 참조할 수 있다.
    ⚠️ 자기 자신이 속한 객체를 재귀적으로 참조하는 방식은 일반적이지 않으며 바람직하지 않다.
  - `this`는 메서드를 호출한 객체를 가리킨다.
- 생성자 함수 방식으로 인스턴스를 생성하는 경우
  - 생성자 함수로 인스턴스를 생성하려면 먼저 생성자 함수가 존재해야 한다.
  - 생성자 함수를 정의하는 시점에는 아직 인스턴스를 생성하기 이전이므로 인스턴스를 가리키는 식별자를 알 수 없다.
    -> 자신이 속한 객체 또는 자신이 생성할 인스턴스를 가리키는 특수한 식별자가 필요하다.
    -> 자바스크립트는 `this`라는 특수한 식별자를 제공한다.
  - `this`는 생성자 함수가 생성할 인스턴스를 가리킨다.
- `this`
  - 자신이 속한 객체 또는 자신이 생성할 인스턴스를 가리키는 자기 참조 변수
  - 자바스크립트 엔진에 의해 암묵적으로 생성되며, 코드 어디서든 참조할 수 있다. (하지만 객체의 프로퍼티나 메서드를 참조하기 위한 자기 참조 변수이므로 일반적으로 객체의 메서드 내부 또는 생성자 함수 내부에서만 의미가 있다.)
  - 일반 함수 내부의 `this`에는 전연 객체를 가리키고, strict mode가 적용된 경우 `undefined`가 바인딩된다.
  - 함수를 호출하면 arguments 객체와 `this`가 암묵적으로 함수 내부에 전달된다.
  - arguments 객체처럼 함수 내부에서 `this`도 지역 변수처럼 사용할 수있다.
  - `this`가 가리키는 값(this 바인딩)은 함수 호출 방식에 의해 동적으로 결정된다.
    💡 바인딩 : 식별자와 값을 연결하는 과정

### 22.2 함수 호출 방식과 this 바인딩

- `this`가 가리키는 값(this 바인딩)은 함수 호출 방식에 의해 동적으로 결정된다.
  ⚠️ 동일한 함수도 다양한 방식으로 호출할 수 있다.

1. **일반 함수 호출** -> 전역 객체
   ex. `foo();`
   - 중첩 함수, 콜백 함수는 외부 함수를 돕는 헬퍼 함수의 역할을 하므로, 외부 함수의 메서드와 this가 일치하지 않는다는 것은 헬퍼 함수로 동작하기 어렵게 만든다.
     ->
   - 외부 함수의 메서드의 this를 변수에 할당하고, 중첩/콜백 함수 내부에서 this 대신 해당 변수를 참조한다.
   - `Function.prototype.apply`, `Function.prototype.call`, `Function.prototype.bind`로 this를 명시적으로 바인딩한다.
   - 화살표 함수로 this 바인딩을 일치시킨다.
2. **메서드 호출** -> 호출한 객체
   ex. `obj.foo();`
   - 메서드를 가리키고 있는 객체와는 관계가 없고 메서드를 호출한 객체에 바인딩된다.
3. **생성자 함수 호출** -> 인스턴스
   ex. `new foo();`
4. Function.prototype.apply/call/bind 메서드에 의한 간접 호출 -> 첫 번째 인수로 전달한 객체
   ex. `foo.call(bar);`,`foo.apply(bar);`,`foo.bind(bar);`
   - apply와 call 메서드
     - 본질적인 기능은 함수를 호출하는 것이다.
     - 대표적인 용도는 arguments 객체와 같은 유사 배열 객체에 배열 메서드를 사용하는 경우다.
   - bind 메서드
     - 함수를 호출하지 않는다.
     - 첫 번째 인수로 전달한 값으로 this 바인딩이 교체된 함수를 새롭게 생성해 반환한다.
