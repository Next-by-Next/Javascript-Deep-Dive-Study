## 43ìž¥ Ajax

### ðŸ“ 43.1: Ajaxëž€?

**Ajax**: ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•´ ë¶€ë¼ìš°ì €ê°€ ì„œë²„ì—ê²Œ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë°ì´í„°ë¥¼ ìš”ì²­í•˜ê³ , ì„œë²„ê°€ ì‘ë‹µí•œ ë°ì´í„°ë¥¼ ìˆ˜ì‹ í•´ ì›¹íŽ˜ì´ì§€ë¥¼ ë™ì ìœ¼ë¡œ ê°±ì‹ í•˜ëŠ” í”„ë¡œê·¸ëž˜ë° ë°©ì‹

AjaxëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” Web APIì¸ `XMLHttpRequest` ê°ì²´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë™ìž‘í•˜ë©°, ì´ ê°ì²´ëŠ” HTTP ë¹„ë™ê¸° í†µì‹ ì„ ìœ„í•œ ë©”ì„œë“œì™€ í”„ë¡œí¼í‹°ë¥¼ ì œê³µí•œë‹¤.  
ì´ì „ì˜ ì›¹íŽ˜ì´ì§€ëŠ” ì™„ì „í•œ HTMLì„ ì„œë²„ë¡œë¶€í„° ì „ì†¡ë°›ì•„ ì›¹íŽ˜ì´ì§€ ì „ì²´ë¥¼ ë¦¬ë Œë”ë§í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ë™ìž‘í–ˆëŠ”ë°, ì´ëŸ° ì „í†µì ì¸ ë°©ì‹ì€ ë‹¤ìŒê³¼ ê°™ì€ ë‹¨ì ì„ ê°–ëŠ”ë‹¤.

- ì´ì „ ì›¹íŽ˜ì´ì§€ê°€ ì°¨ì´ê°€ ì—†ì–´ì„œ ë³€ê²½í•  í•„ìš”ê°€ ì—†ëŠ” ë¶€ë¶„ê¹Œì§€ í¬í•¨í•œ ì™„ì „í•œ HTMLì„ ì„œë²„ë¡œë¶€í„° ë§¤ë²ˆ ë‹¤ì‹œ ì „ì†¡ë°›ê¸° ë•Œë¬¸ì— ë¶ˆí•„ìš”í•œ ë°ì´í„° í†µì‹ ì´ ë°œìƒí•œë‹¤.
- ë³€ê²½í•  í•„ìš”ê°€ ì—†ëŠ” ë¶€ë¶„ê¹Œì§€ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ë Œë”ë§í•œë‹¤. ì´ë¡œ ì¸í•´ í™”ë©´ ì „í™˜ì´ ì¼ì–´ë‚˜ë©´ í™”ë©´ì´ ìˆœê°„ì ìœ¼ë¡œ ê¹œë°•ì´ëŠ” í˜„ìƒì´ ë°œìƒí•œë‹¤.
- í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ì™€ì˜ í†µì‹ ì´ ë™ê¸° ë°©ì‹ìœ¼ë¡œ ë™ìž‘í•˜ê¸° ë•Œë¬¸ì— ì„œë²„ë¡œë¶€í„° ì‘ë‹µì´ ìžˆì„ ë•Œê¹Œì§€ ë‹¤ìŒ ì²˜ë¦¬ëŠ” ë¸”ë¡œí‚¹ëœë‹¤.

Ajaxì˜ ë“±ìž¥ìœ¼ë¡œ ì¸í•´ ì„œë²„ë¡œë¶€í„° ë³€ê²½ì— í•„ìš”í•œ ë°ì´í„°ë§Œ ë¹„ë™ê¸° ë°©ì‹ìœ¼ë¡œ ì „ì†¡ë°›ì•„ ì›¹íŽ˜ì´ì§€ë¥¼ ë³€ê²½í•  í•„ìš”ê°€ ì—†ëŠ” ë¶€ë¶„ì€ ë‹¤ì‹œ ë Œë”ë§í•˜ì§€ ì•Šê³ , ë³€ê²½í•  í•„ìš”ê°€ ìžˆëŠ” ë¶€ë¶„ë§Œ í•œì •ì ìœ¼ë¡œ ë Œë”ë§í•˜ëŠ” ë°©ì‹ì´ ê°€ëŠ¥í•´ì¡Œë‹¤.

### ðŸ“ 43.2: JSON

**JSON**: í´ë¼ì´ì–¸íŠ¸ì™€ ì„œë²„ ê°„ì˜ HTTP í†µì‹ ì„ ìœ„í•œ í…ìŠ¤íŠ¸ ë°ì´í„° í¬ë§· (ìžë°”ìŠ¤í¬ë¦½íŠ¸ì— ì¢…ì†ë˜ì§€ ì•ŠëŠ” ì–¸ì–´ ë…ë¦½í˜• í¬ë§·ìœ¼ë¡œ, ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ëž˜ë° ì–¸ì–´ì—ì„œ ì‚¬ìš© ê°€ëŠ¥)

#### JSON í‘œê¸° ë°©ì‹

ìžë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ê°ì²´ ë¦¬í„°ëŸ´ê³¼ ìœ ì‚¬í•˜ê²Œ í‚¤ì™€ ê°’ìœ¼ë¡œ êµ¬ì„±ëœ ìˆœìˆ˜í•œ í…ìŠ¤íŠ¸ë‹¤.  
JSONì˜ í‚¤ëŠ” ë°˜ë“œì‹œ í°ë”°ì˜´í‘œë¡œ ë¬¶ì–´ì•¼ í•œë‹¤. (ê°’ì€ ìƒê´€ì—†ìŒ)

```json
{
  "name": "Lee",
  "age": 20,
  "alive": true,
  "hobby": ["traveling", "tennis"]
}
```

#### `JSON.stringify`

`JSON.stringify` ë©”ì„œë“œëŠ” ê°ì²´ë¥¼ JSON í¬ë§·ì˜ ë¬¸ìžì—´ë¡œ ë³€í™˜í•œë‹¤.  
í´ë¼ì´ì–¸íŠ¸ê°€ ì„œë²„ë¡œ ê°ì²´ë¥¼ ì „ì†¡í•˜ë ¤ë©´ ê°ì²´ë¥¼ ì´ë ‡ê²Œ ë¬¸ìžì—´í™”í•´ì•¼ í•˜ëŠ”ë°, ì´ë¥¼ ì§ë ¬í™”(serializing)ë¼ í•œë‹¤.  
ê°ì²´ë¿ë§Œ ì•„ë‹ˆë¼ ë°°ì—´ë„ JSON í¬ë§·ì˜ ë¬¸ìžì—´ë¡œ ë³€í™˜í•œë‹¤.

#### `JSON.parse`

JSON í¬ë§·ì˜ ë¬¸ìžì—´ì„ ê°ì²´ë¡œ ë³€í™˜í•œë‹¤.  
ì„œë²„ë¡œë¶€í„° í´ë¼ì´ì–¸íŠ¸ì—ê²Œ ì „ì†¡ëœ JSON ë°ì´í„°ëŠ” ë¬¸ìžì—´ì¸ë°, ì´ ë¬¸ìžì—´ì„ ê°ì²´ë¡œì„œ ì‚¬ìš©í•˜ë ¤ë©´ ì´ë ‡ê²Œ ê°ì²´í™”í•´ì•¼ í•œë‹¤. (deserializing)

### ðŸ“ 43.3: `XMLHttpRequest`

ìžë°”ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•´ HTTP ìš”ì²­ì„ ì „ì†¡í•˜ë ¤ë©´ `XMLHttpRequest` ê°ì²´ë¥¼ ì‚¬ìš©í•œë‹¤.  
Web APIì¸ ì´ ê°ì²´ëŠ” HTTP ìš”ì²­ê³¼ HTTP ì‘ë‹µ ìˆ˜ì‹ ì„ ìœ„í•œ ë‹¤ì–‘í•œ ë©”ì„œë“œì™€ í”„ë¡œí¼í‹°ë¥¼ ì œê³µí•œë‹¤.

#### `XMLHttpRequest` ê°ì²´ ìƒì„±

`XMLHttpRequest` ìƒì„±ìž í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ ìƒì„±í•œë‹¤.  
ì´ ê°ì²´ëŠ” ë¸Œë¼ìš°ì €ì—ì„œ ì œê³µí•˜ëŠ” Web APIì´ë¯€ë¡œ ë¸Œë¼ìš°ì € í™˜ê²½ì—ì„œë§Œ ì •ìƒì ìœ¼ë¡œ ì‹¤í–‰ëœë‹¤.

```javascript
const xhr = new XMLHttpRequest();
```

#### `XMLHttpRequest` ê°ì²´ì˜ í”„ë¡œí¼í‹°ì™€ ë©”ì„œë“œ

**í”„ë¡œí† íƒ€ìž… í”„ë¡œí¼í‹°**

- `readyState`: HTTP ìš”ì²­ì˜ í˜„ìž¬ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜
- `status`: HTTP ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì •ìˆ˜
- `statusText`: HTTP ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ ë©”ì‹œì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ë¬¸ìžì—´
- `responseType`: HTTP ì‘ë‹µ íƒ€ìž…
- `response`: HTTP ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µ body

**ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹°**

- `onreadystatechange`: `readyState` í”„ë¡œí¼í‹° ê°’ì´ ë³€ê²½ëœ ê²½ìš°
- `onerror`: HTTP ìš”ì²­ì— ì—ëŸ¬ê°€ ë°œìƒí•œ ê²½ìš°
- `onload`: HTTP ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œí•œ ê²½ìš°

**ë©”ì„œë“œ**

- `open`: HTTP ìš”ì²­ ì´ˆê¸°í™”
- `send`: HTTP ìš”ì²­ ì „ì†¡
- `abort`: ì´ë¯¸ ì „ì†¡ëœ HTTP ìš”ì²­ ì¤‘ë‹¨
- `setRequestHeader`: íŠ¹ì • HTTP ìš”ì²­ í—¤ë”ì˜ ê°’ì„ ì„¤ì •

#### HTTP ìš”ì²­ ì „ì†¡

1. `XMLHttpRequest.prototype.open` ë©”ì„œë“œë¡œ HTTP ìš”ì²­ì„ ì´ˆê¸°í™”í•œë‹¤.
2. í•„ìš”ì— ë”°ë¼ `XMLHttpRequest.prototype.setRequestHeader` ë©”ì„œë“œë¡œ íŠ¹ì • HTTP ìš”ì²­ì˜ í—¤ë” ê°’ì„ ì„¤ì •í•œë‹¤.
3. `XMLHttpRequest.prototype.send` ë©”ì„œë“œë¡œ HTTP ìš”ì²­ì„ ì „ì†¡í•œë‹¤.

```javascript
const xhr = new XMLHttpRequest();

xhr.open('GET', '/users');

xhr.setRequestHeader('content-type', 'application/json');

xhr.send();
```

#### HTTP ì‘ë‹µ ì²˜ë¦¬

ì„œë²„ê°€ ì „ì†¡í•œ ì‘ë‹µì„ ì²˜ë¦¬í•˜ë ¤ë©´ `XMLHttpRequest` ê°ì²´ê°€ ë°œìƒì‹œí‚¤ëŠ” ì´ë²¤íŠ¸ë¥¼ ìºì¹˜í•´ì•¼ í•œë‹¤.  
ì´ ê°ì²´ê°€ ê°–ëŠ” ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬ í”„ë¡œí¼í‹° ì¤‘ì—ì„œ HTTP ìš”ì²­ì˜ í˜„ìž¬ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” `readyState` í”„ë¡œí¼í‹° ê°’ì´ ë³€ê²½ëœ ê²½ìš° ë°œìƒí•˜ëŠ” `readystatechange` ì´ë²¤íŠ¸ë¥¼ ìºì¹˜í•´ ë‹¤ìŒê³¼ ê°™ì´ HTTP ì‘ë‹µì„ ì²˜ë¦¬í•  ìˆ˜ ìžˆë‹¤.

```javascript
const xhr = new XMLHttpRequest();

xhr.open('GET', 'https://jsonplaceholder.typicode.com/todos/1');

xhr.send();

xhr.onreadystatechange = () => {
  if (xhr.readyState !== XMLHttpRequest.DONE) return;

  if (xhr.status === 200) {
    console.log(JSON.parse(xhr.response));
  } else {
    console.error('Error', xhr.status, xhr.statusText);
  }
};
```

`readystatechange` ëŒ€ì‹  HTTP ìš”ì²­ì´ ì„±ê³µì ìœ¼ë¡œ ì™„ë£Œëœ ê²½ìš° ë°œìƒí•˜ëŠ” `load` ì´ë²¤íŠ¸ë¥¼ ìºì¹˜í•´ë„ ì¢‹ë‹¤.  
í•´ë‹¹ ì´ë²¤íŠ¸ë¥¼ ìºì¹˜í•˜ëŠ” ê²½ìš° `xhr.readyState`ê°€ `XMLHttpRequest.DONE`ì¸ì§€ í™•ì¸í•  í•„ìš”ê°€ ì—†ë‹¤.

```javascript
const xhr = new XMLHttpRequest();

xhr.open('GET', 'https://jsonplaceholder.typicode.com/todos/1');

xhr.send();

xhr.onload = () => {
  if (xhr.status === 200) {
    console.log(JSON.parse(xhr.response));
  } else {
    console.error('Error', xhr.status, xhr.statusText);
  }
};
```
